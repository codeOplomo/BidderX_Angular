<div class="create-auction-page">
    <p-card styleClass="create-auction-card">
        <form [formGroup]="auctionForm" (ngSubmit)="onSubmit()">
            <div class="form-layout">
                <!-- Left Column - Image Upload -->
                <div class="image-upload-section" *ngIf="showNewProductFields">
                    <div class="upload-box">
                        <label>Product Image *</label>
                        <div class="upload-area" (click)="productFileInput.click()">
                            <input #productFileInput type="file" hidden (change)="onUpdateProductImage($event)"
                                accept="image/*" />
                            <ng-container *ngIf="!productPreview; else productPreviewTpl">
                                <div class="upload-placeholder">
                                    <i class="pi pi-plus"></i>
                                </div>
                            </ng-container>
                            <ng-template #productPreviewTpl>
                                <img [src]="productPreview" alt="Product preview" />
                            </ng-template>
                        </div>
                    </div>
                </div>
                <div class="image-upload-section" *ngIf="!showNewProductFields">
                    <!-- Empty placeholder to maintain grid layout -->
                </div>

                <!-- Right Column - Form Fields -->
                <div class="form-fields-section">

                    <!-- New Product Fields -->
                    <div class="new-product-section" *ngIf="showNewProductFields">
                        <div class="new-product-fields">
                            <div class="form-group">
                                <label for="productTitle">Product Title *</label>
                                <input id="productTitle" type="text" class="form-control"
                                    formControlName="productTitle" />
                            </div>

                            <div class="form-group">
                                <label for="manufacturer">Manufacturer *</label>
                                <input id="manufacturer" type="text" class="form-control"
                                    formControlName="manufacturer" />
                            </div>

                            <div class="form-group">
                                <label for="condition">Condition *</label>
                                <input id="condition" type="text" class="form-control" formControlName="condition" />
                            </div>
                        </div>

                        <div class="form-group-row">
                            <div class="form-group">
                                <label for="productionDate">Production Date *</label>
                                <input type="date" id="productionDate" class="form-control"
                                    formControlName="productionDate">
                            </div>
                            <div class="form-group">
                                <label for="category">Category *</label>
                                <select id="category" class="form-control" formControlName="category">
                                    <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group full-width">
                            <label for="productDescription">Product Description *</label>
                            <textarea id="productDescription" rows="4" class="form-control"
                                formControlName="productDescription"></textarea>
                        </div>
                    </div>

                    <div class="form-group-row">
                        <!-- Common Auction Fields -->
                        <div class="auction-title-row">
                            <div class="form-group">
                                <label for="title">Auction Title *</label>
                                <input id="title" type="text" class="form-control" formControlName="title" />
                            </div>
                        </div>

                        <!-- Product Dropdown -->
                        <div class="form-group product-selection-field" *ngIf="!showNewProductFields">
                            <label for="productSelect">Select Product</label>
                            <select id="productSelect" class="form-control" formControlName="existingProductId">
                                <option *ngFor="let product of products" [value]="product.id">{{ product.title }}</option>
                            </select>
                        </div>

                    </div>

                    <div class="form-group-row">
                        <div class="form-group">
                            <label for="startTime">Start Time</label>
                            <input id="startTime" type="datetime-local" class="form-control"
                                formControlName="startTime" />
                        </div>

                        <div class="form-group">
                            <label for="startingPrice">Start Price</label>
                            <input id="startingPrice" type="number" class="form-control"
                                formControlName="startingPrice" />
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label for="description">Auction Description *</label>
                        <textarea id="description" rows="4" class="form-control"
                            formControlName="description"></textarea>
                    </div>

                    
                    <!-- Product Selection Toggle -->
                    <div class="product-selection-section">
                        <div class="explicit-content-toggle">
                            <input type="checkbox" id="createNewProduct" formControlName="createNewProduct"
                                (change)="onCreateNewProductToggle()" />
                            <label for="createNewProduct">Create New Product</label>
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <button type="submit" class="create-button" [disabled]="auctionForm.invalid">
                            Create Auction
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </p-card>
</div>