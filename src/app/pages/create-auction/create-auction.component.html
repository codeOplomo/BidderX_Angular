<div class="create-auction-page">
    <p-card styleClass="create-auction-card">
        <form [formGroup]="auctionForm" (ngSubmit)="onSubmit()">
            <div class="form-layout">
                <!-- Left Column - Image Upload -->
                <div class="image-upload-section" *ngIf="showNewProductFields">
                    <div class="upload-box" *ngFor="let image of productImages; let i = index">
                        <label>
                            <ng-container *ngIf="i === 0; else featuredLabel">
                                Product Image **
                            </ng-container>
                            <ng-template #featuredLabel>
                                Featured Image {{ i }}
                            </ng-template>
                        </label>
                        <div class="upload-area" (click)="input.click()">
                            <input #input type="file" [hidden]="true" (change)="onUpdateProductImage($event, i)"
                                accept="image/*" />
                            <ng-container *ngIf="!image.preview; else productPreviewTpl">
                                <div class="upload-placeholder">
                                    <i class="pi pi-plus"></i>
                                </div>
                            </ng-container>
                            <ng-template #productPreviewTpl>
                                <div class="image-container">
                                    <img [src]="image.preview" alt="Product preview" />
                                    <span class="remove-badge" (click)="removeImage(i); $event.stopPropagation()">
                                        <i class="pi pi-times"></i>
                                    </span>
                                </div>
                            </ng-template>
                        </div>
                    </div>
                </div>

                <div class="image-upload-section" *ngIf="!showNewProductFields">
                    <!-- Empty placeholder to maintain grid layout -->
                </div>


                <!-- Right Column - Form Fields -->
                <div class="form-fields-section">

                    <!-- New Product Fields -->
                    <app-product-form *ngIf="showNewProductFields" [parentForm]="auctionForm">
                    </app-product-form>

                    <div class="form-group-row">
                        <!-- Common Auction Fields -->
                        <div class="auction-title-row">
                            <div class="form-group">
                                <label for="title">Auction Title *</label>
                                <input id="title" type="text" class="form-control" formControlName="title" />
                            </div>
                        </div>

                        <!-- Product Dropdown -->
                        <div class="form-group product-selection-field" *ngIf="!showNewProductFields">
                            <label for="productSelect">Select Product</label>
                            <select id="productSelect" class="form-control" formControlName="existingProductId">
                                <option *ngFor="let product of products" [value]="product.id">{{ product.title }}
                                </option>
                            </select>
                        </div>

                    </div>

                    <div class="form-group-row">
                        <div class="form-group">
                            <label for="startTime">Start Time</label>
                            <input id="startTime" type="datetime-local" class="form-control"
                                formControlName="startTime" />
                        </div>

                        <div class="form-group">
                            <label for="duration">Auction Duration (hours)</label>
                            <input id="duration" type="number" class="form-control"
                                formControlName="auctionDurationInHours" />
                        </div>

                        <div class="form-group">
                            <label for="startingPrice">Start Price</label>
                            <input id="startingPrice" type="number" class="form-control"
                                formControlName="startingPrice" />
                        </div>
                    </div>

                    <div class="form-group full-width">
                        <label for="description">Auction Description *</label>
                        <textarea id="description" rows="4" class="form-control"
                            formControlName="description"></textarea>
                    </div>


                    <!-- Product Selection Toggle -->
                    <div class="product-selection-section">
                        <div class="explicit-content-toggle">
                            <input type="checkbox" id="createNewProduct" formControlName="createNewProduct" />
                            <label for="createNewProduct">Create New Product</label>


                            <div class="form-group">
                                <label for="isInstantAuction">
                                    <input id="isInstantAuction" type="checkbox" formControlName="isInstantAuction" />
                                    Instant Auction
                                </label>
                            </div>

                        </div>
                    </div>

                    <div class="form-group full-width">
                        <button type="submit" class="create-button" [disabled]="auctionForm.invalid">
                            Create Auction
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </p-card>
</div>